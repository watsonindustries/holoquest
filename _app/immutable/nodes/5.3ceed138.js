import{T as ce,S as Z,i as ee,s as te,k as b,q as B,l as y,m as E,r as N,h as g,n as I,b as j,E as d,u as se,U as ie,V as J,a as P,y as ae,c as C,z as ne,M as O,A as oe,R as fe,g as Q,f as ue,d as A,N as pe,B as re,o as de,O as me,P as he,Q as _e,v as ge}from"../chunks/index.11e3f03e.js";import{e as ve}from"../chunks/qr-scanner.min.4880ecae.js";import{s as Se}from"../chunks/crypto.6f6cc81d.js";import{e as be}from"../chunks/const.96e908ff.js";import{I as ye,S as K,Q as L}from"../chunks/index.c098f3de.js";function W(l,{delay:e=0,duration:n=400,easing:t=ce}={}){const o=+getComputedStyle(l).opacity;return{delay:e,duration:n,easing:t,css:s=>`opacity: ${s*o}`}}function Ee(l){let e,n,t,o,s,m,c,S;return{c(){e=b("div"),n=b("div"),t=b("div"),o=b("span"),s=B(l[1]),this.h()},l(u){e=y(u,"DIV",{class:!0});var h=E(e);n=y(h,"DIV",{class:!0});var f=E(n);t=y(f,"DIV",{});var v=E(t);o=y(v,"SPAN",{});var k=E(o);s=N(k,l[1]),k.forEach(g),v.forEach(g),f.forEach(g),h.forEach(g),this.h()},h(){I(n,"class",m="alert alert-"+l[0]),I(e,"class","toast toast-bottom toast-center w-52")},m(u,h){j(u,e,h),d(e,n),d(n,t),d(t,o),d(o,s),S=!0},p(u,[h]){(!S||h&2)&&se(s,u[1]),(!S||h&1&&m!==(m="alert alert-"+u[0]))&&I(n,"class",m)},i(u){S||(ie(()=>{S&&(c||(c=J(n,W,{},!0)),c.run(1))}),S=!0)},o(u){c||(c=J(n,W,{},!1)),c.run(0),S=!1},d(u){u&&g(e),u&&c&&c.end()}}}function Ie(l,e,n){let{type:t}=e,{message:o}=e;return l.$$set=s=>{"type"in s&&n(0,t=s.type),"message"in s&&n(1,o=s.message)},[t,o]}class Ve extends Z{constructor(e){super(),ee(this,e,Ie,Ee,te,{type:0,message:1})}}function X(l,e,n){const t=l.slice();return t[8]=e[n],t}function Y(l){let e,n;const t=[l[8]];let o={};for(let s=0;s<t.length;s+=1)o=me(o,t[s]);return e=new Ve({props:o}),{c(){ae(e.$$.fragment)},l(s){ne(e.$$.fragment,s)},m(s,m){oe(e,s,m),n=!0},p(s,m){const c=m&2?he(t,[_e(s[8])]):{};e.$set(c)},i(s){n||(Q(e.$$.fragment,s),n=!0)},o(s){A(e.$$.fragment,s),n=!1},d(s){re(e,s)}}}function $e(l){let e,n,t,o,s,m,c,S,u,h,f,v,k,w=l[0]==="scanning"?"Stop":"Scan",R,H,V,T,$,M,z,D=l[1],r=[];for(let a=0;a<D.length;a+=1)r[a]=Y(X(l,D,a));const le=a=>A(r[a],1,1,()=>{r[a]=null});return v=new ye({props:{src:l[0]==="scanning"?K:L,theme:"solid",class:"color-gray-900 h-8 w-8"}}),{c(){e=b("div");for(let a=0;a<r.length;a+=1)r[a].c();n=P(),t=b("div"),o=b("h1"),s=B("Scanner"),m=P(),c=b("p"),S=B("Press Scan, and scan the QR code of the stamp!"),u=P(),h=b("div"),f=b("button"),ae(v.$$.fragment),k=P(),R=B(w),H=P(),V=b("div"),T=b("video"),this.h()},l(a){e=y(a,"DIV",{class:!0});var i=E(e);for(let U=0;U<r.length;U+=1)r[U].l(i);i.forEach(g),n=C(a),t=y(a,"DIV",{class:!0});var _=E(t);o=y(_,"H1",{class:!0});var p=E(o);s=N(p,"Scanner"),p.forEach(g),m=C(_),c=y(_,"P",{class:!0});var x=E(c);S=N(x,"Press Scan, and scan the QR code of the stamp!"),x.forEach(g),u=C(_),h=y(_,"DIV",{class:!0});var F=E(h);f=y(F,"BUTTON",{class:!0});var q=E(f);ne(v.$$.fragment,q),k=C(q),R=N(q,w),q.forEach(g),F.forEach(g),H=C(_),V=y(_,"DIV",{id:!0,class:!0});var G=E(V);T=y(G,"VIDEO",{}),E(T).forEach(g),G.forEach(g),_.forEach(g),this.h()},h(){I(e,"class","toast toast-bottom toast-center"),I(o,"class","text-4xl text-center text-primary font-bold"),I(c,"class","text-xl text-center px-2"),I(f,"class","btn rounded-full gap-2 w-6/12 mx-auto"),O(f,"btn-primary",l[0]==="stopped"),O(f,"btn-error",l[0]==="scanning"),I(h,"class","flex flex-col space-y-4 justify-center"),I(V,"id","scanner-preview-area"),I(V,"class","min-h-screen bg-slate-800"),I(t,"class","space-y-4")},m(a,i){j(a,e,i);for(let _=0;_<r.length;_+=1)r[_]&&r[_].m(e,null);j(a,n,i),j(a,t,i),d(t,o),d(o,s),d(t,m),d(t,c),d(c,S),d(t,u),d(t,h),d(h,f),oe(v,f,null),d(f,k),d(f,R),d(t,H),d(t,V),d(V,T),$=!0,M||(z=fe(f,"click",l[2]),M=!0)},p(a,[i]){if(i&2){D=a[1];let p;for(p=0;p<D.length;p+=1){const x=X(a,D,p);r[p]?(r[p].p(x,i),Q(r[p],1)):(r[p]=Y(x),r[p].c(),Q(r[p],1),r[p].m(e,null))}for(ge(),p=D.length;p<r.length;p+=1)le(p);ue()}const _={};i&1&&(_.src=a[0]==="scanning"?K:L),v.$set(_),(!$||i&1)&&w!==(w=a[0]==="scanning"?"Stop":"Scan")&&se(R,w),(!$||i&1)&&O(f,"btn-primary",a[0]==="stopped"),(!$||i&1)&&O(f,"btn-error",a[0]==="scanning")},i(a){if(!$){for(let i=0;i<D.length;i+=1)Q(r[i]);Q(v.$$.fragment,a),$=!0}},o(a){r=r.filter(Boolean);for(let i=0;i<r.length;i+=1)A(r[i]);A(v.$$.fragment,a),$=!1},d(a){a&&g(e),pe(r,a),a&&g(n),a&&g(t),re(v),M=!1,z()}}}function De(l,e,n){let t="stopped",o,s,m="",c=[];const S=be.map(f=>f.hash);function u(){t==="scanning"?(n(0,t="stopped"),s.pause()):t==="stopped"&&(n(0,t="scanning"),s.start())}function h(f){m=f.data,u();let v=Se(m);S.includes(v)?(localStorage.setItem(v,m),n(1,c=[{type:"success",message:"Stamp Saved!"}])):n(1,c=[{type:"error",message:"Invalid Stamp!"}]),setTimeout(()=>{n(1,c=[])},4e3)}return de(()=>{o=document.querySelector("video"),s=new ve(o,h,{highlightScanRegion:!0,highlightCodeOutline:!0})}),[t,c,u]}class Qe extends Z{constructor(e){super(),ee(this,e,De,$e,te,{})}}export{Qe as component};
