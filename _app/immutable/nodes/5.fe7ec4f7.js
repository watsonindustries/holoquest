import{S as de,i as pe,s as me,k as b,q as A,l as y,m as E,r as B,h,n as S,b as L,E as f,u as he,L as _e,V as M,a as R,y as Z,c as T,z as ee,O as C,A as te,U as ve,g as O,f as Se,d as q,P as be,B as se,o as ye,W as Ee,Q as $e,R as xe,T as Ie,v as Ve}from"../chunks/index.109b436a.js";import{e as De}from"../chunks/qr-scanner.min.4880ecae.js";import{s as we}from"../chunks/crypto.6f6cc81d.js";import{f as W,e as ke}from"../chunks/const.20bb8ed5.js";import{I as le,S as ce,Q as ie,E as Pe}from"../chunks/index.74714e33.js";function Qe(i){let a,n,t,r,s,_,l,$;return{c(){a=b("div"),n=b("div"),t=b("div"),r=b("span"),s=A(i[1]),this.h()},l(d){a=y(d,"DIV",{class:!0});var g=E(a);n=y(g,"DIV",{class:!0});var u=E(n);t=y(u,"DIV",{});var v=E(t);r=y(v,"SPAN",{});var P=E(r);s=B(P,i[1]),P.forEach(h),v.forEach(h),u.forEach(h),g.forEach(h),this.h()},h(){S(n,"class",_="alert alert-"+i[0]),S(a,"class","toast-center toast-bottom toast w-52")},m(d,g){L(d,a,g),f(a,n),f(n,t),f(t,r),f(r,s),$=!0},p(d,[g]){(!$||g&2)&&he(s,d[1]),(!$||g&1&&_!==(_="alert alert-"+d[0]))&&S(n,"class",_)},i(d){$||(_e(()=>{$&&(l||(l=M(n,W,{},!0)),l.run(1))}),$=!0)},o(d){l||(l=M(n,W,{},!1)),l.run(0),$=!1},d(d){d&&h(a),d&&l&&l.end()}}}function Re(i,a,n){let{type:t}=a,{message:r}=a;return i.$$set=s=>{"type"in s&&n(0,t=s.type),"message"in s&&n(1,r=s.message)},[t,r]}class Te extends de{constructor(a){super(),pe(this,a,Re,Qe,me,{type:0,message:1})}}function fe(i,a,n){const t=i.slice();return t[8]=a[n],t}function ue(i){let a,n;const t=[i[8]];let r={};for(let s=0;s<t.length;s+=1)r=$e(r,t[s]);return a=new Te({props:r}),{c(){Z(a.$$.fragment)},l(s){ee(a.$$.fragment,s)},m(s,_){te(a,s,_),n=!0},p(s,_){const l=_&2?xe(t,[Ie(s[8])]):{};a.$set(l)},i(s){n||(O(a.$$.fragment,s),n=!0)},o(s){q(a.$$.fragment,s),n=!1},d(s){se(a,s)}}}function Ce(i){let a,n,t,r,s,_,l,$,d,g,u,v,P,j=i[0]==="scanning"?"Stop":"Scan",H,F,x,N,V,G,Q,D,w,J,I,K,ae,k=i[1],o=[];for(let e=0;e<k.length;e+=1)o[e]=ue(fe(i,k,e));const ge=e=>q(o[e],1,1,()=>{o[e]=null});return v=new le({props:{src:i[0]==="scanning"?ce:ie,theme:"solid",class:"color-gray-900",size:"32px"}}),w=new le({props:{src:Pe,theme:"solid",class:"color-gray-900",size:"28px"}}),{c(){a=b("div");for(let e=0;e<o.length;e+=1)o[e].c();n=R(),t=b("div"),r=b("h1"),s=A("Scanner"),_=R(),l=b("p"),$=A("Press Scan, and scan the QR code of the stamp!"),d=R(),g=b("div"),u=b("button"),Z(v.$$.fragment),P=R(),H=A(j),F=R(),x=b("div"),N=b("video"),G=R(),Q=b("div"),D=b("a"),Z(w.$$.fragment),J=A(`
			View collected stamps`),this.h()},l(e){a=y(e,"DIV",{class:!0});var c=E(a);for(let Y=0;Y<o.length;Y+=1)o[Y].l(c);c.forEach(h),n=T(e),t=y(e,"DIV",{class:!0});var p=E(t);r=y(p,"H1",{class:!0});var m=E(r);s=B(m,"Scanner"),m.forEach(h),_=T(p),l=y(p,"P",{class:!0});var z=E(l);$=B(z,"Press Scan, and scan the QR code of the stamp!"),z.forEach(h),d=T(p),g=y(p,"DIV",{class:!0});var ne=E(g);u=y(ne,"BUTTON",{class:!0});var U=E(u);ee(v.$$.fragment,U),P=T(U),H=B(U,j),U.forEach(h),ne.forEach(h),F=T(p),x=y(p,"DIV",{id:!0,class:!0});var oe=E(x);N=y(oe,"VIDEO",{}),E(N).forEach(h),oe.forEach(h),G=T(p),Q=y(p,"DIV",{class:!0});var re=E(Q);D=y(re,"A",{class:!0,href:!0});var X=E(D);ee(w.$$.fragment,X),J=B(X,`
			View collected stamps`),X.forEach(h),re.forEach(h),p.forEach(h),this.h()},h(){S(a,"class","toast-center toast-bottom toast"),S(r,"class","text-center font-geologica text-4xl font-bold text-primary"),S(l,"class","px-2 text-center text-xl"),S(u,"class","btn mx-auto w-6/12 gap-2 rounded-full text-xl"),C(u,"btn-primary",i[0]==="stopped"),C(u,"btn-error",i[0]==="scanning"),S(g,"class","flex flex-col justify-center space-y-4"),S(x,"id","scanner-preview-area"),S(x,"class","h-96"),C(x,"hidden",i[0]==="stopped"),S(D,"class","btn-secondary btn mx-auto mt-2 gap-2 rounded-full text-lg"),S(D,"href","/"),S(Q,"class","flex flex-col justify-center space-y-4"),S(t,"class","space-y-4")},m(e,c){L(e,a,c);for(let p=0;p<o.length;p+=1)o[p]&&o[p].m(a,null);L(e,n,c),L(e,t,c),f(t,r),f(r,s),f(t,_),f(t,l),f(l,$),f(t,d),f(t,g),f(g,u),te(v,u,null),f(u,P),f(u,H),f(t,F),f(t,x),f(x,N),f(t,G),f(t,Q),f(Q,D),te(w,D,null),f(D,J),I=!0,K||(ae=ve(u,"click",i[2]),K=!0)},p(e,[c]){if(c&2){k=e[1];let m;for(m=0;m<k.length;m+=1){const z=fe(e,k,m);o[m]?(o[m].p(z,c),O(o[m],1)):(o[m]=ue(z),o[m].c(),O(o[m],1),o[m].m(a,null))}for(Ve(),m=k.length;m<o.length;m+=1)ge(m);Se()}const p={};c&1&&(p.src=e[0]==="scanning"?ce:ie),v.$set(p),(!I||c&1)&&j!==(j=e[0]==="scanning"?"Stop":"Scan")&&he(H,j),(!I||c&1)&&C(u,"btn-primary",e[0]==="stopped"),(!I||c&1)&&C(u,"btn-error",e[0]==="scanning"),(!I||c&1)&&C(x,"hidden",e[0]==="stopped")},i(e){if(!I){for(let c=0;c<k.length;c+=1)O(o[c]);O(v.$$.fragment,e),_e(()=>{I&&(V||(V=M(x,W,{},!0)),V.run(1))}),O(w.$$.fragment,e),I=!0}},o(e){o=o.filter(Boolean);for(let c=0;c<o.length;c+=1)q(o[c]);q(v.$$.fragment,e),V||(V=M(x,W,{},!1)),V.run(0),q(w.$$.fragment,e),I=!1},d(e){e&&h(a),be(o,e),e&&h(n),e&&h(t),se(v),e&&V&&V.end(),se(w),K=!1,ae()}}}function Oe(i,a,n){let t="stopped",r,s,_="",l=[];const $=ke.map(u=>u.hash);function d(){t==="scanning"?(n(0,t="stopped"),s.pause()):t==="stopped"&&(n(0,t="scanning"),s.start())}function g(u){_=u.data,d();let v=we(_);$.includes(v)?(localStorage.setItem(v,_),n(1,l=[{type:"success",message:"Stamp Saved!"}])):n(1,l=[{type:"error",message:"Invalid Stamp!"}]),setTimeout(()=>{n(1,l=[])},4e3)}return ye(()=>{r=document.querySelector("video"),s=new De(r,g,{highlightScanRegion:!0,highlightCodeOutline:!0})}),Ee(()=>{s==null||s.destroy()}),[t,l,d]}class He extends de{constructor(a){super(),pe(this,a,Oe,Ce,me,{})}}export{He as component};
