import{S as ie,i as de,s as me,k as _,q as k,a as $,y as F,l as g,m as v,r as R,h as u,c as w,z as J,n as h,K as D,b as fe,C as s,A as W,U as pe,u as ue,g as X,L as Z,d as ee,M as te,B as ae,D as se,o as he,Y as Se,T as _e}from"../chunks/index.f2e2f952.js";import{a as ne,n as ge,b as ve}from"../chunks/store.76160239.js";import{e as Ne}from"../chunks/qr-scanner.min.4880ecae.js";import{s as Ee}from"../chunks/crypto.6f6cc81d.js";import{e as ye}from"../chunks/const.e86bc028.js";import{S as r,T as re}from"../chunks/custom.b03ad683.js";import{I as oe,S as le,Q as ce,E as Pe}from"../chunks/index.a116848c.js";import{f as B}from"../chunks/index.f45b4d2e.js";function be(m){let e,c,x,N,l,I,f,p,n,i,T,o=m[0]===r.SCANNING?"Stop":"Scan",P,V,d,A,E,Q,C,y,b,z,U,S,j,H;return i=new oe({props:{src:m[0]===r.SCANNING?le:ce,theme:"solid",class:"color-gray-900",size:"32px"}}),b=new oe({props:{src:Pe,theme:"solid",class:"color-gray-900",size:"28px"}}),{c(){e=_("div"),c=_("h1"),x=k("Scanner"),N=$(),l=_("p"),I=k("Press Scan, and scan the QR code of the stamp!"),f=$(),p=_("div"),n=_("button"),F(i.$$.fragment),T=$(),P=k(o),V=$(),d=_("div"),A=_("video"),Q=$(),C=_("div"),y=_("a"),F(b.$$.fragment),z=k(`
			View collected stamps`),this.h()},l(t){e=g(t,"DIV",{class:!0});var a=v(e);c=g(a,"H1",{class:!0});var O=v(c);x=R(O,"Scanner"),O.forEach(u),N=w(a),l=g(a,"P",{class:!0});var M=v(l);I=R(M,"Press Scan, and scan the QR code of the stamp!"),M.forEach(u),f=w(a),p=g(a,"DIV",{class:!0});var K=v(p);n=g(K,"BUTTON",{class:!0});var G=v(n);J(i.$$.fragment,G),T=w(G),P=R(G,o),G.forEach(u),K.forEach(u),V=w(a),d=g(a,"DIV",{id:!0,class:!0});var L=v(d);A=g(L,"VIDEO",{}),v(A).forEach(u),L.forEach(u),Q=w(a),C=g(a,"DIV",{class:!0});var Y=v(C);y=g(Y,"A",{class:!0,href:!0});var q=v(y);J(b.$$.fragment,q),z=R(q,`
			View collected stamps`),q.forEach(u),Y.forEach(u),a.forEach(u),this.h()},h(){h(c,"class","text-center font-geologica text-4xl font-bold text-primary"),h(l,"class","px-2 text-center text-xl"),h(n,"class","btn mx-auto w-10/12 max-w-screen-lg gap-2 rounded-full text-lg"),D(n,"btn-primary",m[0]===r.STOPPED),D(n,"btn-error",m[0]===r.SCANNING),h(p,"class","flex flex-col justify-center space-y-4"),h(d,"id","scanner-preview-area"),h(d,"class","h-96"),D(d,"hidden",m[0]===r.STOPPED),h(y,"class","btn-secondary btn mx-auto mt-2 w-10/12 max-w-screen-lg gap-2 rounded-full text-lg"),h(y,"href","/"),h(C,"class","flex flex-col justify-center space-y-4"),h(e,"class","space-y-4")},m(t,a){fe(t,e,a),s(e,c),s(c,x),s(e,N),s(e,l),s(l,I),s(e,f),s(e,p),s(p,n),W(i,n,null),s(n,T),s(n,P),s(e,V),s(e,d),s(d,A),s(e,Q),s(e,C),s(C,y),W(b,y,null),s(y,z),S=!0,j||(H=pe(n,"click",m[1]),j=!0)},p(t,[a]){const O={};a&1&&(O.src=t[0]===r.SCANNING?le:ce),i.$set(O),(!S||a&1)&&o!==(o=t[0]===r.SCANNING?"Stop":"Scan")&&ue(P,o),(!S||a&1)&&D(n,"btn-primary",t[0]===r.STOPPED),(!S||a&1)&&D(n,"btn-error",t[0]===r.SCANNING),(!S||a&1)&&D(d,"hidden",t[0]===r.STOPPED)},i(t){S||(X(i.$$.fragment,t),Z(()=>{S&&(E||(E=te(d,B,{},!0)),E.run(1))}),X(b.$$.fragment,t),U||Z(()=>{U=_e(e,B,{delay:500}),U.start()}),S=!0)},o(t){ee(i.$$.fragment,t),E||(E=te(d,B,{},!1)),E.run(0),ee(b.$$.fragment,t),S=!1},d(t){t&&u(e),ae(i),t&&E&&E.end(),ae(b),j=!1,H()}}}function xe(m,e,c){let x,N;se(m,ge,o=>c(5,x=o)),se(m,ve,o=>c(6,N=o));let l=r.STOPPED,I,f,p="";const n=ye.map(o=>o.hash);function i(){l===r.SCANNING?(c(0,l=r.STOPPED),f.pause()):l===r.STOPPED&&(c(0,l=r.SCANNING),f.start())}function T(o){p=o.data,i();let P=Ee(p);n.includes(P)?(localStorage.setItem(P,p),N==null||N.push("collected",{nickname:x}),ne({type:re.SUCCESS,message:"Stamp Saved!"})):ne({type:re.ERROR,message:"Invalid Stamp!"})}return he(()=>{I=document.querySelector("video"),f=new Ne(I,T,{highlightScanRegion:!0,highlightCodeOutline:!0})}),Se(()=>{console.log("Destroying Scanner"),f==null||f.destroy()}),[l,i]}class Ge extends ie{constructor(e){super(),de(this,e,xe,be,me,{})}}export{Ge as component};
